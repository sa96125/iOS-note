# memory control

### Automatic Reference Counting(ARC)

ARC는 메모리를 관리하는 방법 중 하나로, 힙에 저장된 데이터를 가리키는 참조 변수의 갯수를 카운팅하는 것이다. 힙에 저장된 데이터는 사용한 뒤 반드시 메모리에서 해제해야하는 특징을 가지고 있는데 ARC가 힙을 관리하여 자동으로 사용하지 않는 메모리를 해제한다.

자바스크립트에서는 GC(Garbage Collection)이 힙 영역의 메모리를 관리하는데 ARC와 비교할 때 가장 큰 차이점은 참조를 계산하는 시점에 있다. 먼저 GC의 경우는 RunTime에 사용하고 있는 참조를 추적하지만 ARC의 경우 CompileTime에 참조와 해제를 미리 계산하여 프로그램 실행중에는 추적하지 않는다.

RunTime시점에 추가 리소스가 발생하지 않는다는 것과 참조 해제 시점을 파악할 수 있다는 장점이 있지만 순환 참조가 발생하게 되면 메모리가 해제 되지않을 수 있다는 단점을 지니고 있으니 주의해야한다.

{% hint style="info" %}
실제 RC 동작 과정은?

메모리의 참조 횟수(RC)를 계산하여, 참조 횟수가 0이 되면 더 이상 사용하지 않는 메모리라 생각하여 해제한다. 참조 타입의 새로운 변수 생성시 +1, 참조 타입의 기존 변수 변경시 -1, nil 할당시 -1로 계산한다.
{% endhint %}



### Strong

기본적으로 변수에 참조타입을 할당할 때 Strong으로 지정된다. 참조 타입을 사용할 때 가장 주의할 점은 순환참조로 인해 메모리 누수가 발생(memory leak)할 수 있다는 것이다. 순환 참조란 다른 클래스 내부의 프로퍼티에서 서로를 참조한 후, 프로퍼티에 접근할 수 없게 되면 메모리가 계속 사용되고 있는 상태를 말한다.



### Weak(optional)

Strong 참조와는 다르게 변수에 참조 타입이 할당되더라도 참조 갯수를 카운팅하지 않는다. 즉 RC가 0이되면 자동으로 nil이 할당되어 메모리에서 해제된다.



### Unowned

Weak와 마찬가지로 참조 갯수를 카운팅 하지 않는다. 해제된 주소값을 계쏙 들고 있을 가능성이 있다. 즉 에러 발생 확률이 높다는 것을 의미한다.

